---
import ClientLayout from '../../layouts/ClientLayout.astro';

const months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio'];
const scheduledItems = [
  {
    month: 'Febrero',
    items: [
      { product: 'Pack Lectura Primaria 3º-4º', startDate: '3 feb', endDate: '3 abr', status: 'confirmed' },
    ]
  },
  {
    month: 'Marzo',
    items: [
      { product: 'Ábacos de Madera (Set de 5)', startDate: '1 mar', endDate: '1 may', status: 'pending' },
    ]
  },
  {
    month: 'Abril',
    items: [
      { product: 'Set Laboratorio de Ciencias', startDate: '15 abr', endDate: '15 jun', status: 'pending' },
      { product: 'Láminas Anatomía Humana', startDate: '15 abr', endDate: '15 jun', status: 'pending' },
    ]
  },
];
---

<ClientLayout title="Programar alquileres">
  <div class="flex items-center justify-between mb-8">
    <div>
      <h1 class="text-3xl font-semibold mb-2">Programar alquileres</h1>
      <p class="text-[var(--color-text-secondary)]">Planifica tus alquileres para todo el curso escolar</p>
    </div>
    <a href="/catalogo" class="btn btn-primary">
      <i class="ph ph-plus"></i>
      Añadir producto
    </a>
  </div>

  <div class="grid lg:grid-cols-3 gap-8">
    <!-- Calendar View -->
    <div class="lg:col-span-2">
      <div class="card p-6">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-xl font-semibold">Calendario del curso 2025-26</h2>
          <div class="flex items-center gap-2">
            <button class="p-2 hover:bg-[var(--color-cream)] rounded-lg">
              <i class="ph ph-caret-left"></i>
            </button>
            <span class="font-medium">Ene - Jun 2026</span>
            <button class="p-2 hover:bg-[var(--color-cream)] rounded-lg">
              <i class="ph ph-caret-right"></i>
            </button>
          </div>
        </div>

        <!-- Timeline View -->
        <div class="space-y-6">
          {months.map((month, idx) => (
            <div class="relative">
              <div class="flex items-center gap-4 mb-3">
                <div class={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold ${
                  idx === 0 ? 'bg-[var(--color-brown-primary)] text-white' : 'bg-[var(--color-cream)] text-[var(--color-text-secondary)]'
                }`}>
                  {month.slice(0, 3)}
                </div>
                <div class="flex-1 h-px bg-[var(--color-brown-primary)]/10"></div>
              </div>

              {/* Scheduled items for this month */}
              {scheduledItems
                .filter(s => s.month === month)
                .map(schedule => (
                  <div class="ml-14 space-y-2">
                    {schedule.items.map(item => (
                      <div class={`p-4 rounded-[var(--radius-button)] ${
                        item.status === 'confirmed'
                          ? 'bg-[var(--color-success)]/10 border-l-4 border-[var(--color-success)]'
                          : 'bg-[var(--color-cream)] border-l-4 border-[var(--color-brown-primary)]/30'
                      }`}>
                        <div class="flex items-center justify-between">
                          <div>
                            <p class="font-medium">{item.product}</p>
                            <p class="text-sm text-[var(--color-text-muted)]">
                              {item.startDate} - {item.endDate}
                            </p>
                          </div>
                          <span class={`badge ${
                            item.status === 'confirmed'
                              ? 'badge-success'
                              : 'bg-[var(--color-brown-primary)]/10 text-[var(--color-brown-primary)]'
                          }`}>
                            {item.status === 'confirmed' ? 'Confirmado' : 'Pendiente'}
                          </span>
                        </div>
                      </div>
                    ))}
                  </div>
                ))
              }

              {/* Empty state for months without items */}
              {!scheduledItems.some(s => s.month === month) && (
                <div class="ml-14">
                  <button class="w-full p-4 border-2 border-dashed border-[var(--color-brown-primary)]/20 rounded-[var(--radius-button)] text-[var(--color-text-muted)] hover:border-[var(--color-brown-primary)]/40 hover:text-[var(--color-text-secondary)] transition-colors">
                    <i class="ph ph-plus-circle mr-2"></i>
                    Añadir alquiler para {month}
                  </button>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="space-y-6">
      <!-- Summary -->
      <div class="card p-6">
        <h3 class="font-semibold mb-4">Resumen del curso</h3>
        <div class="space-y-4">
          <div class="flex items-center justify-between">
            <span class="text-[var(--color-text-secondary)]">Alquileres programados</span>
            <span class="font-semibold">4</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-[var(--color-text-secondary)]">Confirmados</span>
            <span class="font-semibold text-[var(--color-success)]">1</span>
          </div>
          <div class="flex items-center justify-between">
            <span class="text-[var(--color-text-secondary)]">Pendientes</span>
            <span class="font-semibold text-[var(--color-warning)]">3</span>
          </div>
          <hr class="border-[var(--color-brown-primary)]/10" />
          <div class="flex items-center justify-between">
            <span class="text-[var(--color-text-secondary)]">Total estimado</span>
            <span class="font-semibold text-[var(--color-brown-primary)] text-lg">285€</span>
          </div>
        </div>
      </div>

      <!-- Quick Add -->
      <div class="card p-6">
        <h3 class="font-semibold mb-4">Añadir rápido</h3>
        <p class="text-sm text-[var(--color-text-muted)] mb-4">
          Selecciona un producto del catálogo y elige las fechas
        </p>
        <a href="/catalogo" class="btn btn-secondary w-full">
          <i class="ph ph-magnifying-glass"></i>
          Buscar en catálogo
        </a>
      </div>

      <!-- Tips -->
      <div class="card p-6 bg-[var(--color-brown-primary)]/5">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-full bg-[var(--color-brown-primary)]/10 flex items-center justify-center flex-shrink-0">
            <i class="ph ph-lightbulb text-[var(--color-brown-primary)]"></i>
          </div>
          <div>
            <h4 class="font-semibold mb-1">Consejo</h4>
            <p class="text-sm text-[var(--color-text-secondary)]">
              Programa tus alquileres con antelación para asegurar disponibilidad. Los pedidos trimestrales tienen un 30% de descuento.
            </p>
          </div>
        </div>
      </div>

      <!-- Actions -->
      <div class="space-y-2">
        <button class="btn btn-primary w-full">
          <i class="ph ph-check-circle"></i>
          Confirmar todos los pendientes
        </button>
        <button class="btn btn-secondary w-full">
          <i class="ph ph-download-simple"></i>
          Exportar calendario
        </button>
      </div>
    </div>
  </div>
</ClientLayout>
